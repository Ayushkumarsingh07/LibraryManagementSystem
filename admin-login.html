<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Admin Login - LibraFlow</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen">

    <div class="w-full max-w-md bg-white rounded-xl shadow-md p-8">
        <h2 class="text-2xl font-bold text-center text-gray-800 mb-6">Admin Login</h2>

        <form id="adminLoginForm">
            <div class="mb-4">
                <label for="username" class="block text-sm font-medium text-gray-700">Username</label>
                <input type="text" id="username" required
                    class="w-full px-4 py-2 mt-1 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-indigo-200"/>
            </div>

            <div class="mb-6">
                <label for="password" class="block text-sm font-medium text-gray-700">Password</label>
                <input type="password" id="password" required
                    class="w-full px-4 py-2 mt-1 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-indigo-200"/>
            </div>

            <button type="submit"
                class="w-full bg-indigo-600 text-white py-2 rounded-md hover:bg-indigo-700 transition duration-200">
                Login
            </button>
        </form>

        <hr class="my-6">

        <h3 class="text-xl font-semibold text-gray-700 mb-4">Register New Admin</h3>
        <form id="adminRegisterForm">
            <div class="mb-4">
                <label for="newUsername" class="block text-sm font-medium text-gray-700">New Username</label>
                <input type="text" id="newUsername" required
                    class="w-full px-4 py-2 mt-1 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-indigo-200"/>
            </div>

            <div class="mb-6">
                <label for="newPassword" class="block text-sm font-medium text-gray-700">New Password</label>
                <input type="password" id="newPassword" required
                    class="w-full px-4 py-2 mt-1 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-indigo-200"/>
            </div>

            <button type="submit"
                class="w-full bg-green-600 text-white py-2 rounded-md hover:bg-green-700 transition duration-200">
                Register Admin
            </button>
        </form>

        <p class="mt-4 text-center text-sm text-gray-500">
            ‚Üê <a href="index.html" class="text-indigo-600 hover:underline">Back to Dashboard</a>
        </p>

    </div>

    <script>
        // Redirect if already logged in, after DOM is loaded
        document.addEventListener("DOMContentLoaded", () => {
            if (localStorage.getItem("loggedInAdmin")) {
                window.location.href = "index.html";
            }
        });

        function getRegisteredAdmins() {
            const admins = localStorage.getItem("registeredAdmins");
            return admins ? JSON.parse(admins) : [];
        }

        document.getElementById("adminLoginForm").addEventListener("submit", function (e) {
            e.preventDefault();
            const username = document.getElementById("username").value.trim();
            const password = document.getElementById("password").value.trim();

            const admins = getRegisteredAdmins();
            const isValid = admins.some(admin => admin.username === username && admin.password === password);

            if (isValid) {
                localStorage.setItem("loggedInAdmin", username);
                alert("Login successful!");
                window.location.href = "index.html";
            } else {
                alert("Invalid username or password");
            }
        });

        function logout() {
            localStorage.removeItem("loggedInAdmin");
            window.location.href = "admin-login.html";
        }

        document.getElementById("adminRegisterForm").addEventListener("submit", function (e) {
            e.preventDefault();
            const newUsername = document.getElementById("newUsername").value.trim();
            const newPassword = document.getElementById("newPassword").value.trim();

            if (!newUsername || !newPassword) {
                alert("Please fill in both fields");
                return;
            }

            let admins = getRegisteredAdmins();

            const exists = admins.some(admin => admin.username === newUsername);
            if (exists) {
                alert("Username already exists.");
                return;
            }

            admins.push({ username: newUsername, password: newPassword });
            localStorage.setItem("registeredAdmins", JSON.stringify(admins));
            alert("Admin registered successfully!");
            document.getElementById("adminRegisterForm").reset();
        });
    </script>

<script>
    document.addEventListener("DOMContentLoaded", () => {
        const loggedInAdmin = localStorage.getItem("loggedInAdmin");
        if (loggedInAdmin && window.location.pathname.includes("index.html")) {
            const adminDisplay = document.querySelector(".sidebar .text-sm.font-medium");
            const roleDisplay = document.querySelector(".sidebar .text-xs.text-gray-500");

            if (adminDisplay && roleDisplay) {
                adminDisplay.textContent = loggedInAdmin;
                roleDisplay.textContent = "Administrator";
            }
        }
    });
</script>

</body>
</html>